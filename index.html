<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#6aaa64">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="LADDER">
    <meta name="description" content="Daily word puzzle where you climb through connected words">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- iOS Home Screen Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/icon-180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/icons/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/assets/icons/icon-512.png">
    
    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="/assets/css/main.css">
    
    <title>LADDER - Daily Word Chain</title>
</head>
<body>
    <!-- Landing Page -->
    <div class="landing-page" id="landing-page">
        <div class="landing-header">
            <h1 class="landing-title">LADDER</h1>
            <p class="landing-subtitle">Daily Word Chain Puzzle</p>
            <p class="puzzle-info" id="landing-puzzle-info">Puzzle #1 â€¢ Today</p>
        </div>

        <div class="instructions">
            <h3>How to Play</h3>
            
            <div class="instruction-item">
                <div class="instruction-number">1</div>
                <div class="instruction-text">
                    <strong>Connect the words:</strong> Each word links thematically to the previous one
                </div>
            </div>

            <div class="instruction-item">
                <div class="instruction-number">2</div>
                <div class="instruction-text">
                    <strong>Use the clues:</strong> Some letters are revealed, plus hints below each word
                </div>
            </div>

            <div class="instruction-item">
                <div class="instruction-number">3</div>
                <div class="instruction-text">
                    <strong>Climb the ladder:</strong> Complete all 6 words to finish today's puzzle
                </div>
            </div>
        </div>

        <button class="play-button" onclick="window.gameModule.startGame()">Play Today's Puzzle</button>
        
        <!-- Offline Notice -->
        <div class="offline-notice" id="offline-notice">
            <div>ðŸ“¶ Internet connection required for today's puzzle</div>
            <button class="retry-button" onclick="window.gameModule.retryConnection()">Try Again</button>
        </div>
    </div>

    <!-- Game Page -->
    <div class="container game-page" id="game-page">
        <header class="header">
            <h1 class="title">LADDER</h1>
            <p class="date-info" id="date-display">Puzzle #1 â€¢ Today</p>
        </header>

        <div class="stats">
            <div class="stat timer">
                <div class="stat-value" id="timer">0:00</div>
                <div class="stat-label">Time</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="current-rung">1</div>
                <div class="stat-label">Step</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="tries-left">5</div>
                <div class="stat-label">Tries</div>
            </div>
        </div>

        <div class="game-area">
            <div class="ladder" id="ladder"></div>

            <div class="input-area">
                <input 
                    type="text" 
                    class="guess-input" 
                    id="guess-input" 
                    placeholder="Enter your guess..."
                    maxlength="12"
                    autocomplete="off"
                    spellcheck="false"
                >
                
                <div class="button-group">
                    <button class="btn btn-primary" id="guess-button">Submit</button>
                </div>

                <div class="feedback" id="feedback"></div>
            </div>
        </div>
    </div>

    <!-- Results Popup -->
    <div class="results-popup" id="results-popup">
        <div class="results-content">
            <h2 class="results-title">ðŸŽ‰ Completed!</h2>
            <p class="results-subtitle">Today's LADDER</p>
            <div class="results-time" id="results-time">2:34</div>
            <p class="results-message">You climbed the word ladder!</p>
            
            <div class="share-buttons">
                <button class="share-button share-text" id="share-text">Share via Text</button>
                <button class="share-button share-copy" id="share-copy">Copy Link</button>
            </div>
            
            <button class="share-button play-again" onclick="location.reload()">Play Again Tomorrow</button>
        </div>
    </div>

    <!-- External Libraries -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- Application Modules -->
    <script type="module">
        // Initialize Supabase client and set it globally for modules
        import { supabaseConfig, setSupabaseClient } from './config/supabase-config.js';
        import { initializePWA } from './assets/js/pwa.js';
        import { startGame, retryConnection, updateLandingInfo } from './assets/js/game.js';
        
        // Initialize Supabase client
        const supabaseClient = window.supabase.createClient(supabaseConfig.url, supabaseConfig.anonKey);
        setSupabaseClient(supabaseClient);
        
        // Initialize PWA features
        initializePWA();
        
        // Make game functions globally available for onclick handlers
        window.gameModule = {
            startGame,
            retryConnection
        };
        
        // Initialize landing page info when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            updateLandingInfo();
        });
    </script>
</body>
</html>